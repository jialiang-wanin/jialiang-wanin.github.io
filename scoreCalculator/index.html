<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>專案分數計算器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1, h2 {
            color: #333;
            text-align: center;
        }
        .calculator {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .section {
            margin-bottom: 25px;
            padding: 15px;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .section-title {
            margin-top: 0;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
            color: #2e7d32;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        select, input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 5px;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
        }
        .checkbox-item input[type="checkbox"] {
            width: auto;
            margin-right: 5px;
        }
        .custom-item {
            display: flex;
            align-items: center;
            margin-top: 5px;
        }
        .custom-item input[type="checkbox"] {
            width: auto;
            margin-right: 5px;
        }
        .custom-item input[type="text"] {
            width: 120px;
            margin-left: 5px;
        }
        .extra-complexity {
            display: flex;
            align-items: center;
            margin-top: 10px;
            gap: 10px;
        }
        .extra-complexity input[type="number"] {
            width: 60px;
        }
        .extra-complexity input[type="text"] {
            flex-grow: 1;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin-top: 15px;
        }
        button:hover {
            background-color: #45a049;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9f7ef;
            border-radius: 4px;
            border-left: 5px solid #4CAF50;
        }
        .result h3 {
            margin-top: 0;
            color: #2e7d32;
        }
        .breakdown {
            margin-top: 10px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
            font-size: 14px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        .info-section {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            border-left: 5px solid #2196F3;
        }
        .hidden {
            display: none;
        }
        .step-result {
            background-color: #f1f8e9;
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
            font-weight: bold;
        }
        .complexity-table {
            font-size: 0.9em;
        }
        .project-name {
            font-size: 1.2em;
            font-weight: bold;
            color: #2e7d32;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="calculator">
        <h1>專案分數計算器</h1>
        
        <div class="info-section">
            <h2>計算流程</h2>
            <ol>
                <li>確定基礎績效分（優化或刪減、擴充、全新功能）</li>
                <li>計算複雜度總和和對應的複雜度績效分</li>
                <li>基礎績效分 + 複雜度績效分 = 專案基本分</li>
                <li>專案基本分 × 職等權重 × 年資權重 × 專業負責人權重 = 最終專案分數</li>
            </ol>
        </div>

        <form id="calculatorForm">
            <!-- 專案名稱 -->
            <div class="section">
                <h3 class="section-title">專案資訊</h3>
                <div class="form-group">
                    <label for="projectName">專案名稱：</label>
                    <input type="text" id="projectName" placeholder="請輸入專案名稱" required>
                </div>
            </div>
            
            <!-- 步驟一：基礎績效分 -->
            <div class="section">
                <h3 class="section-title">步驟一：選擇基礎績效分</h3>
                <div class="form-group">
                    <label for="projectType">功能專案文件基礎績效分：</label>
                    <select id="projectType" required>
                        <option value="">請選擇專案類型</option>
                        <option value="0.1">優化或刪減 (0.1)</option>
                        <option value="0.3">擴充 (0.3)</option>
                        <option value="0.8">全新功能 (0.8)</option>
                    </select>
                </div>
                <div id="baseScoreResult" class="step-result hidden"></div>
            </div>

            <!-- 步驟二：複雜度計算 -->
            <div class="section">
                <h3 class="section-title">步驟二：計算複雜度</h3>
                <div class="form-group">
                    <label for="communication">有無平台處以外單位溝通：</label>
                    <select id="communication">
                        <option value="0">無</option>
                        <option value="1">1-2個單位 (+1複雜度)</option>
                        <option value="2">3個單位 (+2複雜度)</option>
                        <option value="3">4個單位 (+3複雜度)</option>
                        <option value="4">5個單位 (+4複雜度)</option>
                    </select>
                    <small style="display: block; margin-top: 5px; color: #666;">(總部企劃/server/營運等，需求方不計入)</small>
                </div>
                
                <div class="form-group">
                    <label>有無其他產品串聯：(每項+1複雜度)</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item"><input type="checkbox" id="appLink" value="1"><label for="appLink">APP</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="mahjongLink" value="1"><label for="mahjongLink">麻將</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="fogLink" value="1"><label for="fogLink">FOG</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="gashLink" value="1"><label for="gashLink">GASH</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="thirdPartyLink" value="1"><label for="thirdPartyLink">第三方登入</label></div>
                    </div>
                    <div class="custom-item">
                        <input type="checkbox" id="customLink1" value="1">
                        <label for="customLink1">其他1:</label>
                        <input type="text" id="customLink1Text" placeholder="輸入產品名稱">
                    </div>
                    <div class="custom-item">
                        <input type="checkbox" id="customLink2" value="1">
                        <label for="customLink2">其他2:</label>
                        <input type="text" id="customLink2Text" placeholder="輸入產品名稱">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="connectedFeatures">連動功能數量：</label>
                    <select id="connectedFeatures">
                        <option value="0">少於3個</option>
                        <option value="1">3-4個 (+1複雜度)</option>
                        <option value="2">5-6個 (+2複雜度)</option>
                        <option value="3">7個或以上 (+3複雜度)</option>
                    </select>
                    <small style="display: block; margin-top: 5px; color: #666;">(首頁/大廳/登入/聊天室/商城等，功能本身不計入)</small>
                </div>
                
                <div class="form-group">
                    <label for="newStrings">新字串量：</label>
                    <select id="newStrings">
                        <option value="0">少於20個</option>
                        <option value="1">20-34個 (+1複雜度)</option>
                        <option value="2">35-49個 (+2複雜度)</option>
                        <option value="3">50個或以上 (+3複雜度)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="urgent">是否為急件：</label>
                    <select id="urgent">
                        <option value="0">否</option>
                        <option value="1">是 (+1複雜度)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="extraComplexity">額外複雜度判定：(考量量體等相關變因)</label>
                    <div class="extra-complexity">
                        <span>+</span>
                        <input type="number" id="extraComplexity" min="0" max="10" value="0" step="1">
                        <span>複雜度，原因：</span>
                        <input type="text" id="extraComplexityReason" placeholder="請輸入額外複雜度的原因">
                    </div>
                </div>

                <div id="complexityResult" class="step-result hidden"></div>

                <div class="complexity-table">
                    <h4>複雜度對應績效分對照表：</h4>
                    <table>
                        <tr>
                            <th>複雜度</th>
                            <td>1</td>
                            <td>2</td>
                            <td>3</td>
                            <td>4</td>
                            <td>5</td>
                            <td>6</td>
                            <td>7</td>
                            <td>8</td>
                            <td>9</td>
                            <td>10</td>
                            <td>10+</td>
                        </tr>
                        <tr>
                            <th>績效分</th>
                            <td>0.02</td>
                            <td>0.06</td>
                            <td>0.1</td>
                            <td>0.15</td>
                            <td>0.23</td>
                            <td>0.35</td>
                            <td>0.5</td>
                            <td>0.7</td>
                            <td>0.9</td>
                            <td>1.1</td>
                            <td>每級+0.2</td>
                        </tr>
                    </table>
                </div>
            </div>

            <!-- 步驟三：基礎績效分 + 複雜度績效分 -->
            <div class="section">
                <h3 class="section-title">步驟三：計算專案基本分</h3>
                <p>基礎績效分 + 複雜度績效分 = 專案基本分</p>
                <div id="baseResult" class="step-result hidden"></div>
            </div>

            <!-- 步驟四：權重計算 -->
            <div class="section">
                <h3 class="section-title">步驟四：應用權重</h3>
                <div class="form-group">
                    <label for="position">職等：</label>
                    <select id="position" required>
                        <option value="">請選擇職等</option>
                        <option value="1.0">實習生/助理 (×1.0)</option>
                        <option value="0.85">企劃師 (×0.85)</option>
                        <option value="0.7">資深以上 (×0.7)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="yearsOfService">年資：</label>
                    <select id="yearsOfService" required>
                        <option value="">請選擇年資</option>
                        <option value="1.0">一年 (×1.0)</option>
                        <option value="0.9">兩年 (×0.9)</option>
                        <option value="0.85">三年 (×0.85)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="isProjectLead">是否為專業負責人：</label>
                    <select id="isProjectLead" required>
                        <option value="1.0">否 (×1.0)</option>
                        <option value="1.2">是 (×1.2)</option>
                    </select>
                </div>
            </div>

            <button type="button" onclick="calculateScore()">計算專案分數</button>
        </form>

        <div id="result" class="result hidden">
            <h3>最終計算結果</h3>
            <div id="projectNameResult" class="project-name"></div>
            <div id="scoreResult"></div>
            <div id="breakdown" class="breakdown"></div>
        </div>
    </div>

    <script>
        // 根據複雜度等級獲取對應的績效分
        function getComplexityScore(level) {
            if (level <= 0) return 0;
            else if (level === 1) return 0.02;
            else if (level === 2) return 0.06;
            else if (level === 3) return 0.1;
            else if (level === 4) return 0.15;
            else if (level === 5) return 0.23;
            else if (level === 6) return 0.35;
            else if (level === 7) return 0.5;
            else if (level === 8) return 0.7;
            else if (level === 9) return 0.9;
            else if (level === 10) return 1.1;
            else return 1.1 + (level - 10) * 0.2; // 10+ 的複雜度，每級+0.2
        }

        function calculateScore() {
            // 獲取專案名稱
            const projectName = document.getElementById('projectName').value.trim();
            if (!projectName) {
                alert('請輸入專案名稱');
                return;
            }
            
            // 步驟一：獲取基礎績效分
            const baseScore = parseFloat(document.getElementById('projectType').value) || 0;
            if (baseScore === 0) {
                alert('請選擇專案類型');
                return;
            }
            
            document.getElementById('baseScoreResult').classList.remove('hidden');
            document.getElementById('baseScoreResult').innerHTML = `基礎績效分：${baseScore.toFixed(2)}`;
            
            // 步驟二：計算複雜度
            // 計算額外複雜度
            let totalComplexity = 0;
            
            // 平台處以外單位溝通
            const communicationComplexity = parseInt(document.getElementById('communication').value) || 0;
            totalComplexity += communicationComplexity;
            
            // 其他產品串聯
            let productLinkComplexity = 0;
            const productLinks = document.querySelectorAll('.checkbox-group input[type="checkbox"]:checked');
            productLinks.forEach(link => {
                productLinkComplexity += parseInt(link.value) || 0;
            });
            
            // 自定義產品串聯1
            if (document.getElementById('customLink1').checked) {
                productLinkComplexity += 1;
            }
            
            // 自定義產品串聯2
            if (document.getElementById('customLink2').checked) {
                productLinkComplexity += 1;
            }
            
            totalComplexity += productLinkComplexity;
            
            // 連動功能數量
            const connectedFeaturesComplexity = parseInt(document.getElementById('connectedFeatures').value) || 0;
            totalComplexity += connectedFeaturesComplexity;
            
            // 新字串量
            const newStringsComplexity = parseInt(document.getElementById('newStrings').value) || 0;
            totalComplexity += newStringsComplexity;
            
            // 急件
            const urgentComplexity = parseInt(document.getElementById('urgent').value) || 0;
            totalComplexity += urgentComplexity;
            
            // 額外複雜度判定
            const extraComplexity = parseInt(document.getElementById('extraComplexity').value) || 0;
            const extraComplexityReason = document.getElementById('extraComplexityReason').value.trim();
            totalComplexity += extraComplexity;
            
            // 計算複雜度績效分
            const complexityScore = getComplexityScore(totalComplexity);
            
            // 準備產品串聯的詳細資訊
            let productLinkDetails = [];
            if (document.getElementById('appLink').checked) productLinkDetails.push("APP");
            if (document.getElementById('mahjongLink').checked) productLinkDetails.push("麻將");
            if (document.getElementById('fogLink').checked) productLinkDetails.push("FOG");
            if (document.getElementById('gashLink').checked) productLinkDetails.push("GASH");
            if (document.getElementById('thirdPartyLink').checked) productLinkDetails.push("第三方登入");
            
            if (document.getElementById('customLink1').checked) {
                const custom1Name = document.getElementById('customLink1Text').value.trim() || "其他1";
                productLinkDetails.push(custom1Name);
            }
            
            if (document.getElementById('customLink2').checked) {
                const custom2Name = document.getElementById('customLink2Text').value.trim() || "其他2";
                productLinkDetails.push(custom2Name);
            }
            
            const productLinkText = productLinkDetails.length > 0 ? productLinkDetails.join(", ") : "無";
            
            document.getElementById('complexityResult').classList.remove('hidden');
            document.getElementById('complexityResult').innerHTML = `
                複雜度總和：${totalComplexity} (溝通: +${communicationComplexity}, 產品串聯: +${productLinkComplexity}, 連動功能: +${connectedFeaturesComplexity}, 新字串量: +${newStringsComplexity}, 急件: +${urgentComplexity}, 額外複雜度: +${extraComplexity})<br>
                複雜度績效分：${complexityScore.toFixed(2)}
            `;
            
            // 步驟三：計算基本分
            const totalBaseAndComplexity = baseScore + complexityScore;
            document.getElementById('baseResult').classList.remove('hidden');
            document.getElementById('baseResult').innerHTML = `
                基礎績效分 (${baseScore.toFixed(2)}) + 複雜度績效分 (${complexityScore.toFixed(2)}) = 專案基本分 ${totalBaseAndComplexity.toFixed(2)}
            `;
            
            // 步驟四：獲取權重
            const positionWeight = parseFloat(document.getElementById('position').value) || 0;
            if (positionWeight === 0) {
                alert('請選擇職等');
                return;
            }
            
            const yearsWeight = parseFloat(document.getElementById('yearsOfService').value) || 0;
            if (yearsWeight === 0) {
                alert('請選擇年資');
                return;
            }
            
            const projectLeadWeight = parseFloat(document.getElementById('isProjectLead').value) || 1.0;
            
            // 計算最終分數
            const finalScore = totalBaseAndComplexity * positionWeight * yearsWeight * projectLeadWeight;
            
            // 顯示結果
            document.getElementById('result').classList.remove('hidden');
            document.getElementById('projectNameResult').innerHTML = `專案名稱：${projectName}`;
            document.getElementById('scoreResult').innerHTML = `<strong>最終專案分數：${finalScore.toFixed(4)}</strong>`;
            
            // 顯示詳細計算過程
            let breakdownHTML = `
                <p><strong>完整計算過程：</strong></p>
                <ol>
                    <li><strong>基礎績效分：</strong> ${baseScore.toFixed(2)}</li>
                    <li><strong>複雜度計算：</strong>
                        <ul>
                            <li>平台處以外單位溝通：+${communicationComplexity}</li>
                            <li>其他產品串聯 (+${productLinkComplexity})：${productLinkText}</li>
                            <li>連動功能數量：+${connectedFeaturesComplexity}</li>
                            <li>新字串量：+${newStringsComplexity}</li>
                            <li>急件：+${urgentComplexity}</li>
            `;
            
            if (extraComplexity > 0) {
                breakdownHTML += `<li>額外複雜度：+${extraComplexity}${extraComplexityReason ? ` (${extraComplexityReason})` : ''}</li>`;
            }
            
            breakdownHTML += `
                            <li>複雜度總和：${totalComplexity}，對應績效分：${complexityScore.toFixed(2)}</li>
                        </ul>
                    </li>
                    <li><strong>專案基本分：</strong> ${baseScore.toFixed(2)} + ${complexityScore.toFixed(2)} = ${totalBaseAndComplexity.toFixed(2)}</li>
                    <li><strong>應用權重：</strong>
                        <ul>
                            <li>職等績效權重：×${positionWeight.toFixed(2)}</li>
                            <li>年資權重：×${yearsWeight.toFixed(2)}</li>
                            <li>專業負責人權重：×${projectLeadWeight.toFixed(1)}</li>
                        </ul>
                    </li>
                </ol>
                <p><strong>最終計算公式：</strong> ${totalBaseAndComplexity.toFixed(2)} × ${positionWeight.toFixed(2)} × ${yearsWeight.toFixed(2)} × ${projectLeadWeight.toFixed(1)} = ${finalScore.toFixed(4)}</p>
            `;
            
            document.getElementById('breakdown').innerHTML = breakdownHTML;
        }
    </script>
</body>
</html>
